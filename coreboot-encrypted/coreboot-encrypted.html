<h1 id="encrypted-gnulinux-with-coreboot-and-grub">Encrypted GNU+Linux with Coreboot and Grub</h1>
<hr />
<p><em>I will be using Parabola GNU+Linux, a fork of Arch, for this example. Most of it will apply to other distros.</em></p>
<h2 id="before-you-start">Before You Start</h2>
<h2 id="compiling-coreboot">compiling coreboot</h2>
<h3 id="grub-options">grub options</h3>
<p>These are the grub modules needed for encryption:</p>
<ul>
<li>crypto</li>
<li>cryptodisk</li>
<li>luks - if you are used luks encryption.</li>
<li>procfs -</li>
<li>archelp</li>
<li>lvm - if you are using lvm.</li>
<li>pbkdf2 - The Password-Based Key Derivation Function 2 module. Used for key stretching</li>
<li>gcry_rijndael - or...</li>
<li>gcry_sha512 - or whatever hash you used during cryptsetup</li>
</ul>
<p>Booting live usb distributions using iso/syslinux:</p>
<ul>
<li>nativedisk</li>
<li>squash4</li>
<li>syslinuxcfg</li>
<li>loopback</li>
</ul>
<h2 id="flashing-coreboot">flashing coreboot</h2>
<p>Some computers will allow you to flash the rom internally first time, others will be write protected so the first time will have to be external. Either way, it is recommended to get an external flasher incase you make a mistake.</p>
<h2 id="launching-distro-live-usb-from-grub">launching distro live usb from grub</h2>
<h2 id="cryptsetup">cryptsetup</h2>
<p><em>cryptsetup</em> is the commandline tool used to access the cryptographic features of the linux kernel.</p>
<p>If you are placing the LUKS key inside initramfs, you should set the /boot directory where it resides to allow root access only. <em>chmod 700 /boot</em></p>
<p>After this you would install your system onto that partiton.</p>
<h2 id="grub-configuration">grub configuration</h2>
<p>Before flashing a rom with this configuration, you can test these commands in the grub minimal commandline first.</p>
<p>You have to manually load the luks and lvm modules 'insmod luks'. It appears to load all it's requirements.</p>
<hr />
<p>https://wiki.openwrt.org/doc/networking/network.interfaces</p>
<p>https://wiki.openwrt.org/doc/uci/network/switch</p>
<p>ip-link man page.</p>
